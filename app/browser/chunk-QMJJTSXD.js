import{a as j}from"./chunk-B3PZXKBL.js";import{b as pe,c as me}from"./chunk-72VNWM2U.js";import"./chunk-QCDHZ2RI.js";import{a as xe,b as Ce}from"./chunk-RUV3PDHP.js";import{b as ye}from"./chunk-U6S6ABR4.js";import{f as k,q as he}from"./chunk-GUBD7BBI.js";import"./chunk-4UOS5OHZ.js";import"./chunk-LOGEYN6E.js";import{b as $}from"./chunk-FMSO7P7I.js";import{a as ne,b as oe}from"./chunk-MIQXFEQ7.js";import{i as _e,j as ue,m as ge,n as fe}from"./chunk-KSZMNY5K.js";import{Aa as t,Ab as J,Ba as O,Bb as X,C as H,Db as Y,Fa as E,Ga as f,Ha as h,J as N,K as V,Kc as le,Lc as re,Mc as ae,N as x,Na as G,Nc as se,O as A,Oa as Q,P as T,Pa as U,Qa as z,Ra as l,Sa as g,Sb as W,Ta as K,V as m,Va as w,W as d,Wa as b,Xa as v,_a as S,a as B,b as L,cd as de,dd as ce,fc as Z,ha as a,hb as D,ib as M,ic as P,jc as I,oa as y,pc as ee,ra as C,ta as _,tc as te,wa as F,xb as q,za as e,zc as ie}from"./chunk-EJ4AR435.js";var Ee=(()=>{class i{constructor(){this.http=x(Y),this.api=x(I),this.notificationService=x(P),this.host=this.api.host,this.expenses=y([]),this.loading_table=y(!1),this.user_balance=y({}),this.laoding_balance=y(!1),this.searchParams=y({expense_category:null,start_date:null,end_date:null}),this.getExpenses()}getExpenses(){this.loading_table.set(!0);let n=this.searchParams(),s={};Object.entries(n).forEach(([o,r])=>{r!=null&&r!==""&&(s[o]=r)}),this.api.get("expense",{params:s}).pipe(H(()=>this.loading_table.set(!1))).subscribe({next:o=>{this.expenses.set(o)}})}static{this.\u0275fac=function(s){return new(s||i)}}static{this.\u0275prov=N({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var be=()=>[10,25,50],Ve=()=>["journal_number","journal_description","journal_notes","payment_date"],we=()=>({width:"95vw"});function Te(i,u){i&1&&(e(0,"tr")(1,"th",32),l(2,"Expense #"),t(),e(3,"th",33),l(4,"Category"),t(),e(5,"th",34),l(6,"Description"),t(),e(7,"th",33),l(8,"Datetime"),t(),e(9,"th",35),l(10,"total"),t(),e(11,"th",36),l(12,"Options"),t()())}function De(i,u){if(i&1){let n=E();e(0,"p-button",39),f("onClick",function(){m(n);let o=h().$implicit,r=h();return d(r.openEditDialog(o))}),t()}}function Me(i,u){if(i&1){let n=E();e(0,"p-button",40),f("onClick",function(){m(n);let o=h().$implicit,r=h();return d(r.openEditHistoryDialog(o))}),t()}if(i&2){let n=h(2);_("loading",n.loadingEditHistory)}}function Pe(i,u){if(i&1&&(e(0,"tr")(1,"td"),l(2),t(),e(3,"td"),l(4),t(),e(5,"td"),l(6),t(),e(7,"td"),l(8),t(),e(9,"td"),l(10),D(11,"currency"),t(),e(12,"td"),C(13,De,1,0,"p-button",37),t(),e(14,"td"),C(15,Me,1,1,"p-button",38),t()()),i&2){let n=u.$implicit;a(2),g(n.journal_number),a(2),g(n.journal_notes||"---"),a(2),g(n.journal_description),a(2),g(n.payment_date),a(2),g(M(11,7,n.total_value)),a(3),_("ngIf",n.journal_number.substr(0,3)!="REC"),a(2),_("ngIf",n.updated_at)}}function Ie(i,u){i&1&&(e(0,"tr")(1,"td",41),l(2,"No Records Found!"),t()())}function ke(i,u){i&1&&(e(0,"tr")(1,"th"),l(2,"Created At"),t(),e(3,"th"),l(4,"Updated At"),t(),e(5,"th"),l(6,"Update Reason"),t(),e(7,"th"),l(8,"Old Value"),t()())}function je(i,u){if(i&1&&(e(0,"tr")(1,"td"),l(2),t(),e(3,"td"),l(4),t(),e(5,"td"),l(6),t(),e(7,"td"),l(8),D(9,"currency"),t()()),i&2){let n=u.$implicit;a(2),g(n.journal_date),a(2),g(n.updated_at),a(2),g(n.update_reason),a(2),K(" ",M(9,4,n.total_value)," ")}}function Fe(i,u){if(i&1&&(e(0,"p-table",42),C(1,ke,9,0,"ng-template",24)(2,je,10,6,"ng-template",25),t()),i&2){let n=h();_("value",n.editHistory)}}function Oe(i,u){if(i&1){let n=E();e(0,"p-button",43),f("onClick",function(){m(n);let o=h();return d(o.editHistoryDialogVisible=!1)}),t()}}function ze(i,u){i&1&&(e(0,"tr")(1,"th"),l(2,"Expense #"),t(),e(3,"th"),l(4,"Description"),t(),e(5,"th"),l(6,"Created At"),t(),e(7,"th"),l(8,"Deleted At"),t(),e(9,"th"),l(10,"Delete Reason"),t(),e(11,"th"),l(12,"total"),t()())}function We(i,u){if(i&1&&(e(0,"tr")(1,"td"),l(2),t(),e(3,"td"),l(4),t(),e(5,"td"),l(6),t(),e(7,"td"),l(8),t(),e(9,"td"),l(10),t(),e(11,"td"),l(12),D(13,"currency"),t()()),i&2){let n=u.$implicit;a(2),g(n.journal_number),a(2),g(n.journal_description),a(2),g(n.payment_date),a(2),g(n.deleted_at),a(2),g(n.delete_reason),a(2),g(M(13,6,n.total_value))}}function Re(i,u){if(i&1&&(e(0,"p-table",44),C(1,ze,13,0,"ng-template",24)(2,We,14,8,"ng-template",25),t()),i&2){let n=h();_("value",n.deletedHistory)("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",S(6,be))("alwaysShowPaginator",!0)}}function Be(i,u){if(i&1){let n=E();e(0,"p-button",43),f("onClick",function(){m(n);let o=h();return d(o.deletedDialogVisible=!1)}),t()}}var ve=(()=>{class i{constructor(){this.userService=x($),this.expensesService=x(Ee),this.api=x(I),this.notification=x(P),this.expenses=this.expensesService.expenses,this.expenses_dialog_visible=!1,this.loading=this.expensesService.loading_table,this.loading_balance=this.expensesService.laoding_balance,this.dialog_mode="add",this.balance=this.expensesService.user_balance,this.userType=this.userService.userType,this.categories=["Medical Supplies","Pet Food","Utilities","Miscellaneous","Salaries","Outsourced","Maintenance","Other"],this.cols=[{field:"journal_number",header:"Expense #"},{field:"journal_notes",header:"Category"},{field:"journal_description",header:"Description"},{field:"payment_date",header:"Datetime"},{field:"total_value",header:"Total"}],this.searchParams=this.expensesService.searchParams,this.editHistoryDialogVisible=!1,this.loadingEditHistory=!1,this.deletedDialogVisible=!1,this.loadingGetDeleted=!1,this.deletedHistory=[]}reset(){this.searchParams.set({expense_category:null,start_date:null,end_date:null}),this.refetchExpenses}addExpense(){this.dialog_mode="add",this.expenses_dialog_visible=!0}openEditDialog(n){this.dialog_mode="edit",this.selected_payment=n,this.expenses_dialog_visible=!0}onExpenseSumbitted(n){this.refetchExpenses()}closeDialog(){this.expenses_dialog_visible=!1}refetchExpenses(){this.expensesService.getExpenses()}refreshBalance(){}openEditHistoryDialog(n){this.loadingEditHistory=!0,this.api.get(`expense/edits/${n.journal_id}`).pipe(H(()=>{this.loadingEditHistory=!1})).subscribe({next:s=>{this.editHistoryDialogVisible=!0,this.editHistory=s}})}getDeletedExpenses(){this.loadingGetDeleted=!0,this.api.get("expense/deleted").pipe(H(()=>{this.loadingGetDeleted=!1})).subscribe({next:n=>{this.deletedDialogVisible=!0,this.deletedHistory=n}})}exportExcel(){let n=[...this.ct.value],s=[];this.ct.filteredValue&&(s=[...this.ct.filteredValue]);let o=[];this.ct.filteredValue?o=[...this.ct.filteredValue]:o=[...this.ct.value];let r=o.map(c=>{let p=c.payment_date?c.payment_date.toString():"";return L(B({},c),{payment_date:p.substring(0,10)})});this.ct.value=r,this.ct.filteredValue&&(this.ct.filteredValue=r),this.ct?.exportCSV(),this.ct.filteredValue&&(this.ct.filteredValue=s),this.ct.value=n}static{this.\u0275fac=function(s){return new(s||i)}}static{this.\u0275cmp=A({type:i,selectors:[["app-expenses-home"]],viewQuery:function(s,o){if(s&1&&G(k,5),s&2){let r;Q(r=U())&&(o.ct=r.first)}},decls:45,vars:44,consts:[["tableSearch",""],["ct",""],[1,"grid","m-1"],[1,"col-12"],[1,"grid"],[1,"col-12","md:col-6","lg:col-2"],["for",""],["placeholder","Select Expense Category",1,"w-full","p-inputtext-sm",3,"ngModelChange","options","showClear","ngModel","filter","autoOptionFocus"],["styleClass","w-full p-inputtext-sm","dateFormat","yy-mm-dd","placeholder","Select Start Date",3,"ngModelChange","ngModel","showIcon","showClear"],["styleClass","w-full p-inputtext-sm","dateFormat","yy-mm-dd","placeholder","Select End Date",3,"ngModelChange","ngModel","showIcon","showClear"],[1,"col-6","md:col-6","lg:col-2","align-self-end"],["label","search","icon","pi pi-search","severity","primary","styleClass","w-full","size","small",3,"onClick","loading"],[1,"col-6","md:col-6","lg:col-1","align-self-end"],["label","reset","icon","pi pi-times","severity","danger","styleClass","w-full","size","small",3,"onClick"],["label","new","icon","pi pi-plus","severity","success","styleClass","w-full","size","small",3,"onClick"],["label","deleted","icon","pi pi-history","severity","contrast","styleClass","w-full","size","small",3,"onClick"],[1,"col-12","md:col-6","lg:col-1","align-self-end"],["label","export","icon","pi pi-file-excel","severity","success","styleClass","w-full","size","small",3,"onClick","outlined"],["styleClass","m-1"],[1,"col-12","md:col-6","lg:col-2","align-self-end"],[1,"p-input-icon-left","w-full"],[1,"pi","pi-search"],["pInputText","","type","search","placeholder","Search in results ...",1,"p-inputtext-sm","w-full",3,"input","value"],["dataKey","journal_id","styleClass","p-datatable-sm mt-2",3,"exportHeader","columns","value","paginator","rows","showCurrentPageReport","rowsPerPageOptions","alwaysShowPaginator","loading","globalFilterFields","filterDelay"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[3,"OnClose","OnSubmit","visible","selected_payment","dialog_mode"],["header","Edit History","position","top",3,"visibleChange","onHide","visible","modal","closable","maximizable"],["pTemplate","content"],["pTemplate","footer"],["header","Deleted Expenses","position","top",3,"visibleChange","onHide","visible","modal","closable","maximizable"],["width","10%"],["width","20%"],["width","30%"],["width","15%"],["colspan","2","width","5%"],["size","small","icon","fas fa-edit","severity","warning",3,"onClick",4,"ngIf"],["size","small","severity","help","icon","pi pi-history",3,"loading","onClick",4,"ngIf"],["size","small","icon","fas fa-edit","severity","warning",3,"onClick"],["size","small","severity","help","icon","pi pi-history",3,"onClick","loading"],["colspan","11"],["dataKey","record_id","styleClass","p-datatable-sm",3,"value"],["label","Close","icon","pi pi-times","severity","secondary","size","small",3,"onClick"],["dataKey","record_id","styleClass","p-datatable-sm",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions","alwaysShowPaginator"]],template:function(s,o){if(s&1){let r=E();e(0,"div",2)(1,"div",3)(2,"p-card")(3,"div",4)(4,"div",5)(5,"label",6),l(6,"Expense Category"),t(),e(7,"p-dropdown",7),v("ngModelChange",function(p){return m(r),b(o.searchParams().expense_category,p)||(o.searchParams().expense_category=p),d(p)}),t()(),e(8,"div",5)(9,"label",6),l(10,"Start Date"),t(),e(11,"p-calendar",8),v("ngModelChange",function(p){return m(r),b(o.searchParams().start_date,p)||(o.searchParams().start_date=p),d(p)}),t()(),e(12,"div",5)(13,"label",6),l(14,"End Date"),t(),e(15,"p-calendar",9),v("ngModelChange",function(p){return m(r),b(o.searchParams().end_date,p)||(o.searchParams().end_date=p),d(p)}),t()(),e(16,"div",10)(17,"p-button",11),f("onClick",function(){return m(r),d(o.refetchExpenses())}),t()(),e(18,"div",12)(19,"p-button",13),f("onClick",function(){return m(r),d(o.reset())}),t()(),e(20,"div",12)(21,"p-button",14),f("onClick",function(){return m(r),d(o.addExpense())}),t()(),e(22,"div",12)(23,"p-button",15),f("onClick",function(){return m(r),d(o.getDeletedExpenses())}),t()(),e(24,"div",16)(25,"p-button",17),f("onClick",function(){return m(r),d(o.exportExcel())}),t()(),e(26,"div",3),O(27,"p-divider",18),t(),e(28,"div",19)(29,"span",20),O(30,"i",21),e(31,"input",22,0),f("input",function(p){m(r);let He=z(34);return d(He.filterGlobal(p.target.value,"contains"))}),t()()()(),e(33,"p-table",23,1),C(35,Te,13,0,"ng-template",24)(36,Pe,16,9,"ng-template",25)(37,Ie,3,0,"ng-template",26),t()()()(),e(38,"expenses-dialog",27),f("OnClose",function(){return m(r),d(o.closeDialog())})("OnSubmit",function(p){return m(r),d(o.onExpenseSumbitted(p))}),t(),e(39,"p-dialog",28),v("visibleChange",function(p){return m(r),b(o.editHistoryDialogVisible,p)||(o.editHistoryDialogVisible=p),d(p)}),f("onHide",function(){return m(r),d(o.editHistory=null)}),C(40,Fe,3,1,"ng-template",29)(41,Oe,1,0,"ng-template",30),t(),e(42,"p-dialog",31),v("visibleChange",function(p){return m(r),b(o.deletedDialogVisible,p)||(o.deletedDialogVisible=p),d(p)}),f("onHide",function(){return m(r),d(o.deletedHistory=[])}),C(43,Re,3,7,"ng-template",29)(44,Be,1,0,"ng-template",30),t()}if(s&2){let r=z(34);a(7),_("options",o.categories)("showClear",!0),w("ngModel",o.searchParams().expense_category),_("filter",!0)("autoOptionFocus",!1),a(4),w("ngModel",o.searchParams().start_date),_("showIcon",!1)("showClear",!0),a(4),w("ngModel",o.searchParams().end_date),_("showIcon",!1)("showClear",!0),a(2),_("loading",o.loading()),a(8),_("outlined",!0),a(6),_("value",r.filters.global==null?null:r.filters.global.value),a(2),_("exportHeader","Expenses")("columns",o.cols)("value",o.expenses())("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",S(40,be))("alwaysShowPaginator",!0)("loading",o.loading())("globalFilterFields",S(41,Ve))("filterDelay",0),a(5),_("visible",o.expenses_dialog_visible)("selected_payment",o.selected_payment)("dialog_mode",o.dialog_mode),a(),F(S(42,we)),w("visible",o.editHistoryDialogVisible),_("modal",!0)("closable",!0)("maximizable",!0),a(3),F(S(43,we)),w("visible",o.deletedDialogVisible),_("modal",!0)("closable",!0)("maximizable",!0)}},dependencies:[q,ee,te,le,Z,j,ne,k,ge,_e,ae,de,xe,J]})}}return i})();var Le=[{path:"",component:ve}],Se=(()=>{class i{static{this.\u0275fac=function(s){return new(s||i)}}static{this.\u0275mod=T({type:i})}static{this.\u0275inj=V({imports:[W.forChild(Le),W]})}}return i})();var Wt=(()=>{class i{static{this.\u0275fac=function(s){return new(s||i)}}static{this.\u0275mod=T({type:i})}static{this.\u0275inj=V({imports:[X,ie,Se,re,j,oe,he,fe,ue,ye,se,pe,me,ce,Ce]})}}return i})();export{Wt as ExpensesModule};
