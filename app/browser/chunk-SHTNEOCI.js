import{b as ae,c as le}from"./chunk-5RWI34IA.js";import{a as _e,b as me}from"./chunk-5HBZH4F2.js";import{i as oe,j as se,m as re,n as pe}from"./chunk-IQYDCUJX.js";import{$a as v,Aa as a,Bc as X,C as P,Db as q,Fa as x,Fb as U,Ga as u,Ha as l,J as k,M as w,Mc as Z,N as C,Na as A,Nc as $,O as N,Oa as H,Oc as ee,Pa as B,Pc as te,Ra as c,U as O,V as p,Va as _,W as m,Wa as g,Xa as h,Za as z,_ as M,_a as D,ed as ie,fd as ne,g as ue,ha as d,hc as Q,i as I,kc as S,l as W,lc as E,nc as R,oa as V,ra as y,rc as G,ta as r,va as F,vc as J,wa as T,wb as L,yb as Y,za as s,zc as K}from"./chunk-ZWYFQ3XA.js";var de=(()=>{class i{constructor(e,n,t){this.http=e,this.api=n,this.notification=t,this.host=this.api.host,this.expensesAccounts=V([]),this.loading_table=V(!1),this.status_action$=new W({}),this.getExpensesAccounts()}getExpensesAccounts(){this.loading_table.set(!0),this.http.get(this.host+"/expense/accounts").subscribe({next:e=>{this.expensesAccounts.set(e)},error:e=>{this.loading_table.set(!1)},complete:()=>{this.loading_table.set(!1)}})}submitExpensePayment(e){this.loading_table.set(!0),this.http.post(this.host+"/expense",e).subscribe({next:n=>{this.notification.showSuccess("Payment added successfully","home"),this.status_action$.next({action:"ADD"})},error:n=>{this.loading_table.set(!1)},complete:()=>{this.loading_table.set(!1)}})}submitExpenseEditPayment(e){this.loading_table.set(!0),this.http.put(this.host+"/expense",e).subscribe({next:n=>{this.notification.showSuccess(),this.status_action$.next({action:"UPDATE"})},error:n=>{this.loading_table.set(!1)},complete:()=>{this.loading_table.set(!1)}})}deletePayment(e){this.loading_table.set(!0),this.http.delete(this.host+"/expense/"+e).subscribe({next:n=>{this.notification.showSuccess("Payment deleted successfully","home"),this.status_action$.next({action:"DELETE"})},error:n=>{this.loading_table.set(!1)},complete:()=>{this.loading_table.set(!1)}})}static{this.\u0275fac=function(n){return new(n||i)(w(U),w(E),w(S))}}static{this.\u0275prov=k({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var ce=ue(_e());var he=["amountInput"],fe=()=>({width:"75vw"}),xe=()=>({"1199px":"85vw","575px":"95vw"}),be=()=>({width:"35vw"}),j=i=>({"ng-invalid ng-dirty":i});function ye(i,b){i&1&&(s(0,"small",21),c(1,"Date is required."),a())}function Ce(i,b){if(i&1){let e=x();s(0,"div",11)(1,"div",7)(2,"label",12),c(3,"Update Reason"),s(4,"span",9),c(5," *"),a()(),s(6,"input",22),h("ngModelChange",function(t){p(e);let o=l(2);return g(o.update_reason,t)||(o.update_reason=t),m(t)}),a()()()}if(i&2){let e=l(2);d(6),F("invalid",!e.update_reason),_("ngModel",e.update_reason)}}function we(i,b){if(i&1){let e=x();s(0,"div",5)(1,"div",6)(2,"div",7)(3,"label",8),c(4,"Category"),s(5,"span",9),c(6," *"),a()(),s(7,"p-dropdown",10),h("ngModelChange",function(t){p(e);let o=l();return g(o.journal_notes,t)||(o.journal_notes=t),m(t)}),a()()(),s(8,"div",11)(9,"div",7)(10,"label",12),c(11,"Description"),s(12,"span",9),c(13," *"),a()(),s(14,"input",13),h("ngModelChange",function(t){p(e);let o=l();return g(o.journal_description,t)||(o.journal_description=t),m(t)}),a()()(),s(15,"div",14)(16,"div",7)(17,"label",15),c(18,"Amount"),s(19,"span",9),c(20," *"),a()(),s(21,"p-inputNumber",16,0),h("ngModelChange",function(t){p(e);let o=l();return g(o.amount,t)||(o.amount=t),m(t)}),u("onFocus",function(t){p(e);let o=l();return m(o.selectInput(t))}),a()()(),s(23,"div",6)(24,"label",17),c(25,"Date"),s(26,"span",9),c(27," *"),a()(),s(28,"p-calendar",18),h("ngModelChange",function(t){p(e);let o=l();return g(o.payment_date,t)||(o.payment_date=t),m(t)}),a(),y(29,ye,2,0,"small",19),a(),y(30,Ce,7,3,"div",20),a()}if(i&2){let e=l();d(7),r("options",e.categories),_("ngModel",e.journal_notes),r("ngClass",v(15,j,e.submitted&&!e.journal_notes)),d(7),_("ngModel",e.journal_description),r("ngClass",v(17,j,e.submitted&&!e.journal_description)),d(7),_("ngModel",e.amount),r("required",!0)("ngClass",v(19,j,e.submitted&&!e.amount)),d(7),_("ngModel",e.payment_date),r("showIcon",!1)("showClear",!0)("readonlyInput",!0)("showTime",!0),d(),r("ngIf",e.submitted&&!e.payment_date),d(),r("ngIf",e.dialog_mode==="edit")}}function De(i,b){if(i&1){let e=x();s(0,"p-button",26),u("onClick",function(){p(e);let t=l(2);return m(t.deleteDialogVisible=!0)}),a()}if(i&2){let e=l(2);r("disabled",e.loading())}}function ve(i,b){if(i&1){let e=x();y(0,De,1,1,"p-button",23),s(1,"p-button",24),u("onClick",function(){p(e);let t=l();return m(t.closeDialog())}),a(),s(2,"p-button",25),u("onClick",function(){p(e);let t=l();return m(t.submitPayment())}),a()}if(i&2){let e=l();r("ngIf",e.dialog_mode==="edit"),d(),r("disabled",e.loading()),d(),r("loading",e.loading())("disabled",e.dialog_mode==="edit"&&!e.update_reason)}}function Se(i,b){if(i&1){let e=x();s(0,"div",5)(1,"div",27)(2,"label",28),c(3,"Delete Reason"),a(),s(4,"input",29),h("ngModelChange",function(t){p(e);let o=l();return g(o.deleteNote,t)||(o.deleteNote=t),m(t)}),a()()()}if(i&2){let e=l();d(4),_("ngModel",e.deleteNote)}}function Ee(i,b){if(i&1){let e=x();s(0,"p-button",30),u("onClick",function(){p(e);let t=l();return m(t.deleteDialogVisible=!1)}),a(),s(1,"p-button",31),u("onClick",function(){p(e);let t=l();return m(t.confirmDelete())}),a()}if(i&2){let e=l();d(),r("disabled",!e.deleteNote)("loading",e.loadingSubmitDelete)}}var lt=(()=>{class i{constructor(){this.visible=!1,this.dialog_mode="add",this.OnClose=new M,this.OnSubmit=new M,this.api=C(E),this.notification=C(S),this.expensesService=C(de),this.dateService=C(me),this.categories=["Medical Supplies","Pet Food","Utilities","Miscellaneous","Salaries","Outsourced","Maintenance","Other"],this.expensesAccounts=this.expensesService.expensesAccounts,this.loading=this.expensesService.loading_table,this.submitted=!1,this.update_reason=null,this.payment_date=this.dateService.getCurrentDatetime(),this.amount=null,this.subscriptions=new I,this.deleteDialogVisible=!1,this.loadingSubmitDelete=!1,this.deleteNote=null}initDialog(){this.submitted=!1,this.amount=null,this.journal_description=null,this.journal_notes=null,this.update_reason=null}closeDialog(){this.OnClose.emit(),this.initDialog()}ngOnInit(){this.subscriptions.add(this.expensesService.status_action$.subscribe(e=>{e.action&&(this.OnSubmit.emit(),this.initDialog(),this.visible=!1,this.expensesService.status_action$.next({}))}))}ngOnDestroy(){this.subscriptions.unsubscribe()}ngOnChanges(){this.visible&&this.dialog_mode==="edit"&&this.selected_payment?(this.journal_description=this.selected_payment.journal_description,this.journal_notes=this.selected_payment.journal_notes,this.amount=this.selected_payment.total_value,this.payment_date=this.dateService.formatDate(this.selected_payment.payment_date,"YYYY-MM-DD HH:mm")):this.visible&&this.dialog_mode==="add"&&(this.payment_date=this.dateService.getCurrentDatetime())}submitPayment(){this.submitted=!0,this.amount>0&&this.payment_date&&this.journal_description&&(this.payment_date=(0,ce.default)(this.payment_date).format("YYYY-MM-DD HH:mm:ss"),this.dialog_mode==="add"?this.expensesService.submitExpensePayment({amount:this.amount,journal_description:this.journal_description,payment_date:this.payment_date,journal_notes:this.journal_notes}):this.expensesService.submitExpenseEditPayment({amount:this.amount,journal_description:this.journal_description,journal_notes:this.journal_notes,payment_date:this.payment_date,journal_id:this.selected_payment.journal_id,update_reason:this.update_reason}))}selectInput(e){e.target.select()}hideDeleteDialog(){this.deleteNote=null,this.deleteDialogVisible=!1}confirmDelete(){this.deleteNote&&(this.loadingSubmitDelete=!0,this.api.delete(`expense/${this.selected_payment.journal_id}?message=${this.deleteNote}`).pipe(P(()=>{this.loadingSubmitDelete=!1})).subscribe({next:()=>{this.deleteDialogVisible=!1,this.visible=!1,this.notification.showSuccess(),this.OnSubmit.emit(),this.initDialog(),this.visible=!1,this.expensesService.status_action$.next({})}}))}static{this.\u0275fac=function(n){return new(n||i)}}static{this.\u0275cmp=N({type:i,selectors:[["expenses-dialog"]],viewQuery:function(n,t){if(n&1&&A(he,5),n&2){let o;H(o=B())&&(t.amountInput=o.first)}},inputs:{visible:"visible",dialog_mode:"dialog_mode",selected_payment:"selected_payment"},outputs:{OnClose:"OnClose",OnSubmit:"OnSubmit"},standalone:!0,features:[O,z],decls:6,vars:16,consts:[["amountInput",""],["position","top","header","Submit Expense","styleClass","p-fluid",3,"visibleChange","onHide","modal","visible","breakpoints","closeOnEscape","closable","maximizable"],["pTemplate","content"],["pTemplate","footer"],["header","Confirm","position","center",3,"visibleChange","onHide","visible","modal","closable"],[1,"formgrid","grid"],[1,"field","col-12","md:col-3"],[1,"flex","flex-column","gap-2"],["for","category"],[1,"text-red-500"],["styleClass","p-inputtext-sm","placeholder","Select Category","appendTo","body","scrollHeight","300px","autoOptionFocus","false",3,"ngModelChange","options","ngModel","ngClass"],[1,"field","col-12","md:col-4"],["for","Type"],["type","text","pInputText","",1,"p-inputtext-sm",3,"ngModelChange","ngModel","ngClass"],[1,"field","col-12","md:col-2"],["for","amount"],["styleClass","input-align-center","mode","currency","currency","USD","locale","en-US","step","0",1,"p-inputtext-sm",3,"ngModelChange","onFocus","ngModel","required","ngClass"],["for","payment_date"],["styleClass","p-inputtext-sm w-full","appendTo","body","dateFormat","yy-mm-dd","placeholder","Date",3,"ngModelChange","ngModel","showIcon","showClear","readonlyInput","showTime"],["class","p-error",4,"ngIf"],["class","field col-12 md:col-4",4,"ngIf"],[1,"p-error"],["type","text","pInputText","",1,"p-inputtext-sm",3,"ngModelChange","ngModel"],["size","small","label","Delete","icon","pi pi-trash","severity","danger","styleClass","w-full mt-4 md:w-auto md:mt-0",3,"disabled","onClick",4,"ngIf"],["size","small","label","Cancel","icon","pi pi-times","severity","secondary","styleClass","w-full mt-2 md:w-auto md:ml-2",3,"onClick","disabled"],["size","small","label","Finish","icon","pi pi-check","severity","success","styleClass","w-full mt-2 md:w-auto md:ml-2",3,"onClick","loading","disabled"],["size","small","label","Delete","icon","pi pi-trash","severity","danger","styleClass","w-full mt-4 md:w-auto md:mt-0",3,"onClick","disabled"],[1,"field","col-12"],["for","note"],["type","text","id","note","name","note","required","","pInputText","","spellcheck","false",1,"w-full","p-inputtext-sm",3,"ngModelChange","ngModel"],["label","Cancel","icon","pi pi-times","severity","secondary","size","small",3,"onClick"],["label","Proceed","icon","pi pi-check","severity","danger","size","small",3,"onClick","disabled","loading"]],template:function(n,t){n&1&&(s(0,"p-dialog",1),h("visibleChange",function(f){return g(t.visible,f)||(t.visible=f),f}),u("onHide",function(){return t.closeDialog()}),y(1,we,31,21,"ng-template",2)(2,ve,3,4,"ng-template",3),a(),s(3,"p-dialog",4),h("visibleChange",function(f){return g(t.deleteDialogVisible,f)||(t.deleteDialogVisible=f),f}),u("onHide",function(){return t.hideDeleteDialog()}),y(4,Se,5,1,"ng-template",2)(5,Ee,2,2,"ng-template",3),a()),n&2&&(T(D(13,fe)),r("modal",!0),_("visible",t.visible),r("breakpoints",D(14,xe))("closeOnEscape",!1)("closable",!0)("maximizable",!0),d(3),T(D(15,be)),_("visible",t.deleteDialogVisible),r("modal",!0)("closable",!0))},dependencies:[ne,ie,Q,$,Z,se,oe,pe,re,le,ae,X,R,G,K,J,q,L,Y,te,ee],styles:[".invalid[_ngcontent-%COMP%]{border-color:var(--red-500)!important}"]})}}return i})();export{lt as a};
