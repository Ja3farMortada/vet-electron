import{a as j}from"./chunk-VLJRGGRR.js";import{b as oe,c as le}from"./chunk-WDELD5GV.js";import"./chunk-62KZJRW3.js";import{b as _e}from"./chunk-HNVGMNUW.js";import{f as I,q as ce}from"./chunk-XWQWXCJJ.js";import"./chunk-2ZWKMAAH.js";import"./chunk-2SWSMTKN.js";import{b as J}from"./chunk-33OCOHTZ.js";import{a as $,b as ee}from"./chunk-CHMREBLI.js";import{i as se,j as pe,m as me,n as de}from"./chunk-QMHA4MBC.js";import{Aa as t,Ab as G,C as H,Cb as K,Fa as E,Ga as h,Ha as f,J as O,Jc as te,K as V,Kc as ie,Mc as ne,N as x,Na as B,O as R,Oa as N,P as T,Pa as A,Ra as l,Rb as z,Sa as u,Ta as L,V as m,Va as w,W as d,Wa as b,Xa as S,_a as v,bd as ae,cd as re,ec as q,ha as a,hb as D,hc as P,ib as M,ic as k,oa as y,oc as X,ra as C,sc as Y,ta as _,wa as F,wb as Q,yc as Z,za as e,zb as U}from"./chunk-XKMXT5SE.js";var ue=(()=>{class i{constructor(){this.http=x(K),this.api=x(k),this.notificationService=x(P),this.host=this.api.host,this.expenses=y([]),this.loading_table=y(!1),this.user_balance=y({}),this.laoding_balance=y(!1),this.searchParams=y({expense_category:null,start_date:null,end_date:null}),this.getExpenses()}getExpenses(){this.loading_table.set(!0);let n=this.searchParams(),s={};Object.entries(n).forEach(([o,r])=>{r!=null&&r!==""&&(s[o]=r)}),this.api.get("expense",{params:s}).pipe(H(()=>this.loading_table.set(!1))).subscribe({next:o=>{this.expenses.set(o)}})}static{this.\u0275fac=function(s){return new(s||i)}}static{this.\u0275prov=O({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();var he=()=>[10,25,50],Ce=()=>["journal_number","journal_description","payment_date"],ge=()=>({width:"95vw"});function ye(i,c){i&1&&(e(0,"tr")(1,"th",26),l(2,"Expense #"),t(),e(3,"th",27),l(4,"Category"),t(),e(5,"th",28),l(6,"Description"),t(),e(7,"th",27),l(8,"Datetime"),t(),e(9,"th",29),l(10,"total"),t(),e(11,"th",30),l(12,"Options"),t()())}function Ee(i,c){if(i&1){let n=E();e(0,"p-button",33),h("onClick",function(){m(n);let o=f().$implicit,r=f();return d(r.openEditDialog(o))}),t()}}function we(i,c){if(i&1){let n=E();e(0,"p-button",34),h("onClick",function(){m(n);let o=f().$implicit,r=f();return d(r.openEditHistoryDialog(o))}),t()}if(i&2){let n=f(2);_("loading",n.loadingEditHistory)}}function be(i,c){if(i&1&&(e(0,"tr")(1,"td"),l(2),t(),e(3,"td"),l(4),t(),e(5,"td"),l(6),t(),e(7,"td"),l(8),t(),e(9,"td"),l(10),D(11,"currency"),t(),e(12,"td"),C(13,Ee,1,0,"p-button",31),t(),e(14,"td"),C(15,we,1,1,"p-button",32),t()()),i&2){let n=c.$implicit;a(2),u(n.journal_number),a(2),u(n.journal_notes||"---"),a(2),u(n.journal_description),a(2),u(n.payment_date),a(2),u(M(11,7,n.total_value)),a(3),_("ngIf",n.journal_number.substr(0,3)!="REC"),a(2),_("ngIf",n.updated_at)}}function Se(i,c){i&1&&(e(0,"tr")(1,"td",35),l(2,"No Records Found!"),t()())}function ve(i,c){i&1&&(e(0,"tr")(1,"th"),l(2,"Created At"),t(),e(3,"th"),l(4,"Updated At"),t(),e(5,"th"),l(6,"Update Reason"),t(),e(7,"th"),l(8,"Old Value"),t()())}function He(i,c){if(i&1&&(e(0,"tr")(1,"td"),l(2),t(),e(3,"td"),l(4),t(),e(5,"td"),l(6),t(),e(7,"td"),l(8),D(9,"currency"),t()()),i&2){let n=c.$implicit;a(2),u(n.journal_date),a(2),u(n.updated_at),a(2),u(n.update_reason),a(2),L(" ",M(9,4,n.total_value)," ")}}function Ve(i,c){if(i&1&&(e(0,"p-table",36),C(1,ve,9,0,"ng-template",18)(2,He,10,6,"ng-template",19),t()),i&2){let n=f();_("value",n.editHistory)}}function Te(i,c){if(i&1){let n=E();e(0,"p-button",37),h("onClick",function(){m(n);let o=f();return d(o.editHistoryDialogVisible=!1)}),t()}}function De(i,c){i&1&&(e(0,"tr")(1,"th"),l(2,"Expense #"),t(),e(3,"th"),l(4,"Description"),t(),e(5,"th"),l(6,"Created At"),t(),e(7,"th"),l(8,"Deleted At"),t(),e(9,"th"),l(10,"Delete Reason"),t(),e(11,"th"),l(12,"total"),t()())}function Me(i,c){if(i&1&&(e(0,"tr")(1,"td"),l(2),t(),e(3,"td"),l(4),t(),e(5,"td"),l(6),t(),e(7,"td"),l(8),t(),e(9,"td"),l(10),t(),e(11,"td"),l(12),D(13,"currency"),t()()),i&2){let n=c.$implicit;a(2),u(n.journal_number),a(2),u(n.journal_description),a(2),u(n.payment_date),a(2),u(n.deleted_at),a(2),u(n.delete_reason),a(2),u(M(13,6,n.total_value))}}function Pe(i,c){if(i&1&&(e(0,"p-table",38),C(1,De,13,0,"ng-template",18)(2,Me,14,8,"ng-template",19),t()),i&2){let n=f();_("value",n.deletedHistory)("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",v(6,he))("alwaysShowPaginator",!0)}}function ke(i,c){if(i&1){let n=E();e(0,"p-button",37),h("onClick",function(){m(n);let o=f();return d(o.deletedDialogVisible=!1)}),t()}}var fe=(()=>{class i{constructor(){this.userService=x(J),this.expensesService=x(ue),this.api=x(k),this.notification=x(P),this.expenses=this.expensesService.expenses,this.expenses_dialog_visible=!1,this.loading=this.expensesService.loading_table,this.loading_balance=this.expensesService.laoding_balance,this.dialog_mode="add",this.balance=this.expensesService.user_balance,this.userType=this.userService.userType,this.categories=["Medical Supplies","Pet Food","Utilities","Miscellaneous","Salaries","Other"],this.cols=[{field:"journal_number",header:"Expense #"},{field:"journal_notes",header:"Category"},{field:"journal_description",header:"Description"},{field:"payment_date",header:"Datetime"},{field:"total_value",header:"Total"}],this.searchParams=this.expensesService.searchParams,this.editHistoryDialogVisible=!1,this.loadingEditHistory=!1,this.deletedDialogVisible=!1,this.loadingGetDeleted=!1,this.deletedHistory=[]}reset(){this.searchParams.set({expense_category:null,start_date:null,end_date:null}),this.refetchExpenses}addExpense(){this.dialog_mode="add",this.expenses_dialog_visible=!0}openEditDialog(n){this.dialog_mode="edit",this.selected_payment=n,this.expenses_dialog_visible=!0}onExpenseSumbitted(n){this.refetchExpenses()}closeDialog(){this.expenses_dialog_visible=!1}refetchExpenses(){this.expensesService.getExpenses()}refreshBalance(){}openEditHistoryDialog(n){this.loadingEditHistory=!0,this.api.get(`expense/edits/${n.journal_id}`).pipe(H(()=>{this.loadingEditHistory=!1})).subscribe({next:s=>{console.log(s),this.editHistoryDialogVisible=!0,this.editHistory=s}})}getDeletedExpenses(){this.loadingGetDeleted=!0,this.api.get("expense/deleted").pipe(H(()=>{this.loadingGetDeleted=!1})).subscribe({next:n=>{this.deletedDialogVisible=!0,this.deletedHistory=n}})}exportExcel(){this.ct?.exportCSV()}static{this.\u0275fac=function(s){return new(s||i)}}static{this.\u0275cmp=R({type:i,selectors:[["app-expenses-home"]],viewQuery:function(s,o){if(s&1&&B(I,5),s&2){let r;N(r=A())&&(o.ct=r.first)}},decls:38,vars:41,consts:[["ct",""],[1,"grid","m-1"],[1,"col-12"],[1,"grid"],[1,"col-12","md:col-6","lg:col-2"],["for",""],["placeholder","Select Expense Category",1,"w-full","p-inputtext-sm",3,"ngModelChange","options","showClear","ngModel"],["styleClass","w-full p-inputtext-sm","dateFormat","yy-mm-dd","placeholder","Select Start Date",3,"ngModelChange","ngModel","showIcon","showClear"],["styleClass","w-full p-inputtext-sm","dateFormat","yy-mm-dd","placeholder","Select End Date",3,"ngModelChange","ngModel","showIcon","showClear"],[1,"col-6","md:col-6","lg:col-2","align-self-end"],["label","search","icon","pi pi-search","severity","primary","styleClass","w-full","size","small",3,"onClick","loading"],[1,"col-6","md:col-6","lg:col-1","align-self-end"],["label","reset","icon","pi pi-times","severity","danger","styleClass","w-full","size","small",3,"onClick"],["label","new","icon","pi pi-plus","severity","success","styleClass","w-full","size","small",3,"onClick"],["label","deleted","icon","pi pi-history","severity","contrast","styleClass","w-full","size","small",3,"onClick"],[1,"col-12","md:col-6","lg:col-1","align-self-end"],["label","export","icon","pi pi-file-excel","severity","success","styleClass","w-full","size","small",3,"onClick","outlined"],["dataKey","journal_id","styleClass","p-datatable-sm",3,"exportHeader","columns","value","paginator","rows","showCurrentPageReport","rowsPerPageOptions","alwaysShowPaginator","loading","globalFilterFields","filterDelay"],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],[3,"OnClose","OnSubmit","visible","selected_payment","dialog_mode"],["header","Edit History","position","top",3,"visibleChange","onHide","visible","modal","closable","maximizable"],["pTemplate","content"],["pTemplate","footer"],["header","Deleted Expenses","position","top",3,"visibleChange","onHide","visible","modal","closable","maximizable"],["width","10%"],["width","20%"],["width","30%"],["width","15%"],["colspan","2","width","5%"],["size","small","icon","fas fa-edit","severity","warning",3,"onClick",4,"ngIf"],["size","small","severity","help","icon","pi pi-history",3,"loading","onClick",4,"ngIf"],["size","small","icon","fas fa-edit","severity","warning",3,"onClick"],["size","small","severity","help","icon","pi pi-history",3,"onClick","loading"],["colspan","11"],["dataKey","record_id","styleClass","p-datatable-sm",3,"value"],["label","Close","icon","pi pi-times","severity","secondary","size","small",3,"onClick"],["dataKey","record_id","styleClass","p-datatable-sm",3,"value","paginator","rows","showCurrentPageReport","rowsPerPageOptions","alwaysShowPaginator"]],template:function(s,o){if(s&1){let r=E();e(0,"div",1)(1,"div",2)(2,"p-card")(3,"div",3)(4,"div",4)(5,"label",5),l(6,"Expense Category"),t(),e(7,"p-dropdown",6),S("ngModelChange",function(p){return m(r),b(o.searchParams().expense_category,p)||(o.searchParams().expense_category=p),d(p)}),t()(),e(8,"div",4)(9,"label",5),l(10,"Start Date"),t(),e(11,"p-calendar",7),S("ngModelChange",function(p){return m(r),b(o.searchParams().start_date,p)||(o.searchParams().start_date=p),d(p)}),t()(),e(12,"div",4)(13,"label",5),l(14,"End Date"),t(),e(15,"p-calendar",8),S("ngModelChange",function(p){return m(r),b(o.searchParams().end_date,p)||(o.searchParams().end_date=p),d(p)}),t()(),e(16,"div",9)(17,"p-button",10),h("onClick",function(){return m(r),d(o.refetchExpenses())}),t()(),e(18,"div",11)(19,"p-button",12),h("onClick",function(){return m(r),d(o.reset())}),t()(),e(20,"div",11)(21,"p-button",13),h("onClick",function(){return m(r),d(o.addExpense())}),t()(),e(22,"div",11)(23,"p-button",14),h("onClick",function(){return m(r),d(o.getDeletedExpenses())}),t()(),e(24,"div",15)(25,"p-button",16),h("onClick",function(){return m(r),d(o.exportExcel())}),t()()(),e(26,"p-table",17,0),C(28,ye,13,0,"ng-template",18)(29,be,16,9,"ng-template",19)(30,Se,3,0,"ng-template",20),t()()()(),e(31,"expenses-dialog",21),h("OnClose",function(){return m(r),d(o.closeDialog())})("OnSubmit",function(p){return m(r),d(o.onExpenseSumbitted(p))}),t(),e(32,"p-dialog",22),S("visibleChange",function(p){return m(r),b(o.editHistoryDialogVisible,p)||(o.editHistoryDialogVisible=p),d(p)}),h("onHide",function(){return m(r),d(o.editHistory=null)}),C(33,Ve,3,1,"ng-template",23)(34,Te,1,0,"ng-template",24),t(),e(35,"p-dialog",25),S("visibleChange",function(p){return m(r),b(o.deletedDialogVisible,p)||(o.deletedDialogVisible=p),d(p)}),h("onHide",function(){return m(r),d(o.deletedHistory=[])}),C(36,Pe,3,7,"ng-template",23)(37,ke,1,0,"ng-template",24),t()}s&2&&(a(7),_("options",o.categories)("showClear",!0),w("ngModel",o.searchParams().expense_category),a(4),w("ngModel",o.searchParams().start_date),_("showIcon",!1)("showClear",!0),a(4),w("ngModel",o.searchParams().end_date),_("showIcon",!1)("showClear",!0),a(2),_("loading",o.loading()),a(8),_("outlined",!0),a(),_("exportHeader","Expenses")("columns",o.cols)("value",o.expenses())("paginator",!0)("rows",10)("showCurrentPageReport",!0)("rowsPerPageOptions",v(37,he))("alwaysShowPaginator",!0)("loading",o.loading())("globalFilterFields",v(38,Ce))("filterDelay",0),a(5),_("visible",o.expenses_dialog_visible)("selected_payment",o.selected_payment)("dialog_mode",o.dialog_mode),a(),F(v(39,ge)),w("visible",o.editHistoryDialogVisible),_("modal",!0)("closable",!0)("maximizable",!0),a(3),F(v(40,ge)),w("visible",o.deletedDialogVisible),_("modal",!0)("closable",!0)("maximizable",!0))},dependencies:[Q,X,Y,te,q,j,$,I,me,se,ae,U]})}}return i})();var Ie=[{path:"",component:fe}],xe=(()=>{class i{static{this.\u0275fac=function(s){return new(s||i)}}static{this.\u0275mod=T({type:i})}static{this.\u0275inj=V({imports:[z.forChild(Ie),z]})}}return i})();var Ht=(()=>{class i{static{this.\u0275fac=function(s){return new(s||i)}}static{this.\u0275mod=T({type:i})}static{this.\u0275inj=V({imports:[G,Z,xe,ie,j,ee,ce,de,pe,_e,ne,oe,le,re]})}}return i})();export{Ht as ExpensesModule};
